{
  "0": "SELECT \n    (COUNT(DISTINCT CASE WHEN c.Currency = 'EUR' THEN c.CustomerID END) * 1.0) / \n    NULLIF(COUNT(DISTINCT CASE WHEN c.Currency = 'CZK' THEN c.CustomerID END), 0) AS ratio\nFROM \n    customers c\nJOIN \n    transactions_1k t ON c.CustomerID = t.CustomerID;\t----- bird -----\tdebit_card_specializing",
  "1": "SELECT \n    y.CustomerID \nFROM \n    yearmonth y\nJOIN \n    customers c ON y.CustomerID = c.CustomerID\nWHERE \n    y.Date BETWEEN 201201 AND 201212\nGROUP BY \n    y.CustomerID\nORDER BY \n    SUM(y.Consumption) ASC\nLIMIT 1;\t----- bird -----\tdebit_card_specializing",
  "2": "SELECT \n    AVG(y.Consumption) AS average_monthly_consumption\nFROM \n    yearmonth y\nJOIN \n    customers c ON y.CustomerID = c.CustomerID\nWHERE \n    y.Date BETWEEN 201301 AND 201312 \n    AND c.Segment = 'SME';\t----- bird -----\tdebit_card_specializing",
  "3": "SELECT \n    SUM(CASE WHEN c.Currency = 'CZK' THEN y.Consumption ELSE 0 END) - \n    SUM(CASE WHEN c.Currency = 'EUR' THEN y.Consumption ELSE 0 END) AS consumption_difference\nFROM \n    yearmonth y\nJOIN \n    customers c ON y.CustomerID = c.CustomerID\nWHERE \n    y.Date BETWEEN 201201 AND 201212;\t----- bird -----\tdebit_card_specializing",
  "4": "SELECT \n    SUBSTRING(y.Date, 1, 4) AS year, \n    SUM(y.Consumption) AS total_consumption\nFROM \n    yearmonth y\nJOIN \n    customers c ON y.CustomerID = c.CustomerID\nWHERE \n    c.Currency = 'CZK'\nGROUP BY \n    year\nORDER BY \n    total_consumption DESC\nLIMIT 1;\t----- bird -----\tdebit_card_specializing",
  "5": "SELECT \n    SUBSTRING(y.Date, 5, 2) AS month, \n    SUM(y.Consumption) AS total_consumption\nFROM \n    yearmonth y\nJOIN \n    customers c ON y.CustomerID = c.CustomerID\nWHERE \n    y.Date BETWEEN 201301 AND 201312 \n    AND c.Segment = 'SME'\nGROUP BY \n    month\nORDER BY \n    total_consumption DESC\nLIMIT 1;\t----- bird -----\tdebit_card_specializing",
  "6": "WITH segment_consumption AS (\n    SELECT \n        c.Segment,\n        SUM(y.Consumption) AS total_consumption,\n        COUNT(DISTINCT y.CustomerID) AS customer_count\n    FROM \n        yearmonth y\n    JOIN \n        customers c ON y.CustomerID = c.CustomerID\n    WHERE \n        y.Date BETWEEN 201301 AND 201312\n        AND c.Currency = 'CZK'\n    GROUP BY \n        c.Segment\n),\nmin_consumption AS (\n    SELECT \n        c.Segment,\n        MIN(sc.total_consumption) AS min_consumption\n    FROM \n        segment_consumption sc\n    JOIN \n        customers c ON sc.Segment = c.Segment\n    GROUP BY \n        c.Segment\n),\nannual_average AS (\n    SELECT \n        sc.Segment,\n        (sc.total_consumption / NULLIF(sc.customer_count, 0)) AS annual_average\n    FROM \n        segment_consumption sc\n    JOIN \n        min_consumption mc ON sc.Segment = mc.Segment\n    WHERE \n        sc.total_consumption = mc.min_consumption\n)\nSELECT \n    (SELECT annual_average FROM annual_average WHERE Segment = 'SME') - \n    (SELECT annual_average FROM annual_average WHERE Segment = 'LAM') AS SME_LAM_difference,\n    (SELECT annual_average FROM annual_average WHERE Segment = 'LAM') - \n    (SELECT annual_average FROM annual_average WHERE Segment = 'KAM') AS LAM_KAM_difference,\n    (SELECT annual_average FROM annual_average WHERE Segment = 'KAM') - \n    (SELECT annual_average FROM annual_average WHERE Segment = 'SME') AS KAM_SME_difference;\t----- bird -----\tdebit_card_specializing",
  "7": "WITH consumption_data AS (\n    SELECT \n        c.Segment,\n        SUM(y.Consumption) AS total_consumption,\n        SUBSTRING(y.Date, 1, 4) AS year\n    FROM \n        yearmonth y\n    JOIN \n        customers c ON y.CustomerID = c.CustomerID\n    WHERE \n        c.Currency = 'EUR' \n        AND y.Date BETWEEN 201201 AND 201312\n    GROUP BY \n        c.Segment, year\n),\nyearly_totals AS (\n    SELECT \n        Segment,\n        COALESCE(MAX(CASE WHEN year = '2012' THEN total_consumption END), 0) AS consumption_2012,\n        COALESCE(MAX(CASE WHEN year = '2013' THEN total_consumption END), 0) AS consumption_2013\n    FROM \n        consumption_data\n    GROUP BY \n        Segment\n),\npercentage_increase AS (\n    SELECT \n        Segment,\n        (consumption_2013 - consumption_2012) AS increase,\n        (CASE \n            WHEN consumption_2012 > 0 THEN (consumption_2013 - consumption_2012) * 100.0 / consumption_2012\n            ELSE NULL\n         END) AS percentage_increase\n    FROM \n        yearly_totals\n)\nSELECT \n    Segment,\n    percentage_increase\nFROM \n    percentage_increase\nORDER BY \n    percentage_increase DESC;\t----- bird -----\tdebit_card_specializing",
  "8": "SELECT \n    SUM(Consumption) AS total_consumption\nFROM \n    yearmonth\nWHERE \n    CustomerID = 6 \n    AND Date BETWEEN 201308 AND 201311;\t----- bird -----\tdebit_card_specializing",
  "9": "SELECT \n    (SELECT COUNT(*) FROM gasstations WHERE Country = 'CZE' AND Segment = 'discount') -\n    (SELECT COUNT(*) FROM gasstations WHERE Country = 'SVK' AND Segment = 'discount') AS difference;\t----- bird -----\tdebit_card_specializing",
  "10": "WITH czk_smes AS (\n    SELECT DISTINCT c.CustomerID\n    FROM customers c\n    JOIN transactions_1k t ON c.CustomerID = t.CustomerID\n    WHERE c.Currency = 'CZK'\n),\neur_smes AS (\n    SELECT DISTINCT c.CustomerID\n    FROM customers c\n    JOIN transactions_1k t ON c.CustomerID = t.CustomerID\n    WHERE c.Currency = 'EUR'\n)\nSELECT \n    (SELECT COUNT(*) FROM czk_smes) - \n    (SELECT COUNT(*) FROM eur_smes) AS difference;\t----- bird -----\tdebit_card_specializing",
  "11": "WITH total_lam_customers AS (\n    SELECT COUNT(DISTINCT c.CustomerID) AS total_count\n    FROM customers c\n    WHERE c.Segment = 'LAM'\n),\nlam_customers_above_threshold AS (\n    SELECT COUNT(DISTINCT c.CustomerID) AS count_above_threshold\n    FROM customers c\n    JOIN yearmonth y ON c.CustomerID = y.CustomerID\n    WHERE c.Segment = 'LAM' AND y.Consumption > 46.73\n)\nSELECT \n    (lam.count_above_threshold * 100.0 / total.total_count) AS percentage\nFROM \n    total_lam_customers total, \n    lam_customers_above_threshold lam;\t----- bird -----\tdebit_card_specializing",
  "12": "WITH total_customers AS (\n    SELECT COUNT(DISTINCT CustomerID) AS total_count\n    FROM yearmonth\n    WHERE Date = '201202'\n),\ncustomers_above_threshold AS (\n    SELECT COUNT(DISTINCT CustomerID) AS count_above_threshold\n    FROM yearmonth\n    WHERE Date = '201202' AND Consumption > 528.3\n)\nSELECT \n    (customers_above_threshold.count_above_threshold * 100.0 / total_customers.total_count) AS percentage\nFROM \n    total_customers, \n    customers_above_threshold;\t----- bird -----\tdebit_card_specializing",
  "13": "SELECT \n    MAX(monthly_consumption) AS highest_monthly_consumption\nFROM (\n    SELECT \n        SUM(Consumption) AS monthly_consumption\n    FROM \n        yearmonth\n    WHERE \n        Date BETWEEN '201201' AND '201212'\n    GROUP BY \n        SUBSTRING(Date, 5, 2)  -- Extracting the month from the Date\n) AS monthly_totals;\t----- bird -----\tdebit_card_specializing"
}